<html>
	<head>
		<meta charset="utf-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="stylesheet" type="text/css" href="style.css" media="screen"/>
		<script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
		
		<title>Desafio Frontend</title>
		
		<script>
			$(document).ready(function() {
			/*conecta com o servidor e busca informações json*/
				$.getJSON("http://localhost/projeto/urls.json", function(data) {
				//ordena e imprime o TOP 5 com base nas informações json
					arr = data.sort(function(a,b) {
					 return b["hits"] - a["hits"];
					 });
					var tabela="";
					for(i=0;i<5;i++){
						var url = arr[i]['shortUrl'];
						var hits = arr[i]['hits'];
						tabela=tabela+"<tr><td>" + url +"</td><td>" + hits +"</td></tr>";	
					}
					table.innerHTML = tabela;
				});
				
				//controles de animação 
				$("#botao").click(function() { 
					ajax_animacao();
				});
				$("span").click(function() { 
					var acao="clicou";
					limpar_link(acao);
				});
				$("input").change(function() { 
					var acao="apagou";
					limpar_link(acao);
				});
				
			});
			
			function ajax_animacao(){
				if (document.getElementById("link").value != "") {                //o botão só funciona se houver conteudo
					$('input').css('color', 'white');                             //muda a cor do link exibido 
					document.getElementById("link").value="http://chr.dc/xyzxyz"; //muda o link exibido
					botao.innerText = "COPIAR";								      //muda o "nome" do botão
					$('span').show();											  //exibe o X para apagar
				}
			}
			
			
			function limpar_link(acao){
			if((acao=="clicou") ||(acao=="apagou" && document.getElementById("link").value=="")){ //só ocorre se apertar o X ou apagar tudo e sair do input
				document.getElementById("link").value="";										  //apaga link exibido caso ainda exista
				$('input').css('color', '#ff6e15');												  //devolve a cor laranja
				botao.innerText = "ENCURTAR";													  //devolve nome
				$('span').hide();																  //esconde X
				}
			}
								
				
			
		</script>
	</head>
	<body>
		<div class="container">
			<header><img src="../Assets/logo-chaordic.png"></header>
			<div class="banner">
				<div class="texto">
					<h1>Encurte seus links.</h1>
					<p>
						Links são longos.Encurte os links que você deseja compartilhar,<br>
						e acompanhe enquanto viajam através da internet.
					</p>
					
				</div>
				<div class="animacao">
				  <input type="text" name="link" id="link" placeholder="Cole o seu link aqui">
				  <span animacao_limpar>&times;</span>
				</div>
				<button id="botao">ENCURTAR</button>
			</div>
			
			<div class="info">
			
				TOP 5
				<br>
				<br>
				<!-- Tabela carregada em caso do arquivo json não existir ou der erro de permissão-->
				<table id="table"> 
					<tr>
						<td>http://chr.dc/xyzxyz</td>
						<td>7.919</td>
					</tr>
					<tr>
						<td>http://chr.dc/abcabc</td>
						<td>6.899</td>
					</tr>
					<tr>
						<td>http://chr.dc/derder</td>
						<td>2.111</td>
					</tr>
					<tr>
						<td>http://chr.dc/fghfgh</td>
						<td>617</td>
					</tr>
					<tr>
						<td style="border-bottom: 0px;">http://chr.dc/yuiyui</td>
						<td style="border-bottom: 0px;">43</td>
					</tr>
				</table>
			</div>
			
			<!-- efeito de triangulo invertido acima de"hits"-->
			<div class="seta">
				<span class="seta-baixo"></span>
			</div>
			
			<div class="hits">
				<br>
				HITS
				<div class="hits_value">
					35.713.571
				</div>
				<p>Cliques em links</p>
				<div class="footer">
					<footer>
						<table>
							<tr>
								<td style="border-bottom: 0px;">chr.dc</td>
								<td style="border-bottom: 0px;">
									<img src="../Assets/icon-twitter.png">
									<img src="../Assets/icon-facebook.png">
								</td>
							</tr>
						</table>
					</footer>
				</div>
			</div>
		</div>
	</body>
</html>